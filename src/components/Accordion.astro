---
import { Icon } from "astro-icon/components";
import { cn } from "~/lib/cn";

interface Props {
  key: string;
  canOpen?: boolean;
}

const { key, canOpen = true } = Astro.props;
---

<label
  class={cn(
    "h-fit overflow-hidden rounded-lg border-2 border-gray-200 shadow-sm md:max-w-96",
    {
      "cursor-pointer hover:border-purple-500": canOpen,
      "hover:border-slate-500": !canOpen,
    },
  )}
  for={`accordion-toggle/${key}`}
>
  <input
    type="checkbox"
    id={`accordion-toggle/${key}`}
    class="peer hidden"
    disabled={!canOpen}
  />
  <div class="relative block select-none p-3 font-semibold">
    <slot name="title" />
    {
      canOpen && (
        <Icon
          name="mdi:chevron-down"
          class="absolute right-4 top-1/2 -translate-y-1/2 transform transition-transform duration-200"
        />
      )
    }
  </div>
  <div
    class="max-h-0 overflow-hidden transition-all duration-300 ease-in-out peer-checked:max-h-96"
  >
    <div class="px-3 pb-3">
      <slot />
    </div>
  </div>
</label>

<style>
  .peer:checked ~ label > svg {
    @apply rotate-180;
  }
</style>
